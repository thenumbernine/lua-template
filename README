This is the template function that was in my LuaJIT-driven HydroCL project.
I liked it so much I put it in its own project, so other projects could use it.
